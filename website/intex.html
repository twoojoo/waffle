<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Waffle</title>
  <meta name="description" content="A Fastify wrapper that makes HTTP servers stupidly easy to build">
  <meta name="author" content="SitePoint">

  <meta property="og:title" content="Waffle">
  <meta property="og:type" content="website">
  <!-- <meta property="og:url" content="https://www.sitepoint.com/a-basic-html5-template/"> -->
  <meta property="og:description" content="A Fastify wrapper that makes HTTP servers stupidly easy to build">
  <meta property="og:image" content="image.png">

  <link rel="icon" href="../logo.png">
  <link rel="icon" href="../logo.png" type="image/png">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kavoon">
  <!-- <link rel="apple-touch-icon" href="/apple-touch-icon.png"> -->

  <link rel="stylesheet" href="./style.css">
</head>

<body style="margin: 0;">
  <div id="main-pane">

  <!--   <div id="top-bar"> 
    </div> -->

    <div id="main-container">
    <img id="waffle-image" src="./public/waffle.png" alt="logo">
    <div id="main-title-container">
      <div id="main-title" class="main-title prevent-select">Waffle</div>
      <div id="main-subtitle" class="main-title prevent-select">A Fastify wrapper that makes HTTP servers stupidly easy to build</div>
    </div>
    </div>

  <div class="code-sample">
      <div class="code-block">
        npm i @twoojoo/waffle
      </div>
      <div class="code-text prevent-select" align="left">
        <div class="code-title" align="right">
          Installation
        </div>
      </div>
  </div>

  <div class="code-sample">
      <div class="code-text prevent-select" align="right">
        <div class="code-title">One-line ping<br>pong server</div>
        <div class="code-description">Default address:<br>0.0.0.0:80 </div>
      </div>
      <div class="code-block">
        import { Server } from "@twoojoo/waffle"<br><br>
        Server().get("/ping").handler(async (_, rep) => rep.send("pong")).listen()
      </div>
  </div>

  <div class="code-sample">
      <div class="code-block">
        import { Server } from "../src"<br><br>

const server = Server({ logger: true })<br><br>

type User = {<br>
  &emsp;&emsp;&emsp;id: number,<br>
  &emsp;&emsp;&emsp;name: string,<br>
}<br><br>

let users: User[] = [<br>
  &emsp;&emsp;&emsp;{ id: 1, name: "John" }, <br>
  &emsp;&emsp;&emsp;{ id: 2, name: "Angela" }, <br>
  &emsp;&emsp;&emsp;{ id: 3, name: "Bob" }<br>
]<br><br>

// <mehtod> http://lcoalhost:3000/v1/users<br><br>

server.version(1)<br>
  &emsp;&emsp;&emsp;.prefix("users")<br><br>

  &emsp;&emsp;&emsp;.get<{ Params: { id: number } }>(":id")<br>
  &emsp;&emsp;&emsp;.handler(async (req, rep) => rep.send(users.find(u => u.id == req.params.id)))<br><br>

  &emsp;&emsp;&emsp;.delete<{ Params: { id: number } }>(":id")<br>
  &emsp;&emsp;&emsp;.handler(async (req, rep) => {<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;const id = (req.params as any).id<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;const user = users.find(u => u == id)<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;users = users.filter(u => u != id)<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;rep.send(user)<br>
  &emsp;&emsp;&emsp;})<br><br>

  &emsp;&emsp;&emsp;.post<{ Body: User }>()<br>
  &emsp;&emsp;&emsp;.handler(async (req, rep) => {<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;users.push(req.body)<br>
    &emsp;&emsp;&emsp;rep.send(req.body)<br>
  &emsp;&emsp;&emsp;})<br><br>

  &emsp;&emsp;&emsp;.put<{ Params: { id: number }, Body: Omit&lt;User, "id"&gt; }>(":id")<br>
  &emsp;&emsp;&emsp;.handler(async (req, rep) => {<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;const index = users.findIndex(u => u.id == req.params.id)<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;users[index].name = req.body.name<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;rep.send(users[index])<br>
  &emsp;&emsp;&emsp;})<br>
      </div>
      <div class="code-text prevent-select" align="left">
        <div class="code-title">Rest API</div>
        <div class="code-description"></div>
      </div>
  </div>

  </div>
  <script src="./index.js"></script>
</body>
</html>